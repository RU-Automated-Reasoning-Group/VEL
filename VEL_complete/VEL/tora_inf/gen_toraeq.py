import imp
import sys
sys.path.append('../')
from gen_plot import gen_plot_mean_and_std

# log1 = [0.03478142, 0.03497337, 0.03492072, 0.03436492, 0.03437679, 0.03407764, 0.033855710000000004, 0.03388932, 0.03344217, 0.03372788, 0.03342534, 0.03340784, 0.03335315, 0.03297087, 0.03279974, 0.03270914, 0.03269586, 0.03194951, 0.03186175, 0.03181048, 0.03177257, 0.03160653, 0.031219030000000002, 0.03137659, 0.03147976, 0.030967429999999997, 0.030582409999999997, 0.030196300000000002, 0.029960670000000002, 0.02941724, 0.029447920000000002, 0.029471920000000002, 0.02932177, 0.02930903, 0.029455870000000002, 0.02937869, 0.02872189, 0.028697519999999997, 0.02871986, 0.02837969, 0.02734963, 0.027209530000000003, 0.02718304, 0.026289359999999998, 0.02610259, 0.02602268, 0.02600658, 0.025988010000000002, 0.026168019999999997, 0.02579558, 0.02562625, 0.025397140000000002, 0.02525193, 0.025163359999999996, 0.024601949999999997, 0.02477818, 0.02471503, 0.02440476, 0.02420835, 0.023674100000000003, 0.023249010000000004, 0.02310706, 0.022482009999999997, 0.02323414, 0.02165699, 0.02154708, 0.0212639, 0.02099487, 0.02085078, 0.02068366, 0.02047421, 0.020133029999999996, 0.02000724, 0.019932190000000002, 0.018909839999999997, 0.0188544, 0.01880681, 0.01868969, 0.01846203, 0.01805659, 0.01749825, 0.01733906, 0.017886060000000002, 0.0170451, 0.01631153, 0.01617741, 0.015739829999999996, 0.01513859, 0.014918519999999998, 0.014914179999999999, 0.01460177, 0.01427145, 0.01413014, 0.014062389999999998, 0.013859479999999999, 0.01377478, 0.013646090000000001, 0.01361351, 0.01355497, 0.01353712, 0.01332995, 0.013289690000000002, 0.01287647, 0.01281189, 0.01257349, 0.01287087, 0.01277233, 0.01245534, 0.012378169999999999, 0.01201683, 0.011915760000000001, 0.0116888, 0.011671889999999999, 0.011607119999999999, 0.010956210000000001, 0.0109744, 0.01086366, 0.01053769, 0.010441780000000001, 0.01032753, 0.00989379, 0.00953138, 0.00911718, 0.008901949999999999, 0.00878981, 0.00838217, 0.0082828, 0.00877916, 0.00786952, 0.007735519999999999, 0.00759276, 0.0075402, 0.00729407, 0.00713799, 0.00691223, 0.00579152, 0.004862222, 0.004990665, 0.0038401399999999997, 0.004701229, 0.003930587, 0.004017464, 0.003961461, 0.0031875570000000006, 0.003045265, 0.001949791, 0.001811244, 0.001727655, 0.0014337299999999998, 0.000989417, 0.001023223, 0.0014414080000000001, 0.001174406, 0.001159574, 0.000693812, 0.00058425993, 0.0006898480000000001, 0.000532015, 0.0007165728, 0.000556605, 0.0005307370000000001, 0.000528684, 0.000478355, 0.000678327, 0.00030353439999999997, 0.0002107034, 0.0001582632, 0.0001264167, 0.0001253081, 8.811100000000001e-05, 0.00022292999999999998, 0.000589284, 0.000123273, 0.000109544, 0.000171697, 7.76341e-05, 7.2663e-05, 9.25097e-05, 6.80304e-06, 3.78669e-05, 0.0]
# log2 = [0.03478142, 0.03455414, 0.03449125, 0.03440931, 0.03464549, 0.033979560000000006, 0.03393479, 0.0339055, 0.033895400000000006, 0.03385296, 0.033805579999999995, 0.03384778, 0.03320941, 0.032740130000000006, 0.03227604, 0.03194699, 0.03191977, 0.03188537, 0.03175039, 0.03138368, 0.03148713, 0.03102028, 0.03091989, 0.03051679, 0.030389320000000004, 0.03039017, 0.030168069999999998, 0.03008586, 0.02970696, 0.02987765, 0.0299422, 0.029656159999999997, 0.02924173, 0.02914563, 0.028976509999999997, 0.02860004, 0.02849037, 0.0283667, 0.02812632, 0.02804636, 0.02790561, 0.027755969999999998, 0.027832779999999998, 0.02778008, 0.02727568, 0.02720802, 0.027169890000000002, 0.0271416, 0.02711037, 0.026643570000000002, 0.02629322, 0.02626957, 0.02616352, 0.02619481, 0.02599796, 0.02578677, 0.025400950000000002, 0.025514540000000002, 0.02544644, 0.02537609, 0.025133379999999997, 0.025089939999999998, 0.02504751, 0.024726449999999997, 0.02431504, 0.02396053, 0.02360712, 0.023356339999999996, 0.02281377, 0.022208830000000002, 0.02131102, 0.021277039999999997, 0.020472749999999998, 0.02039716, 0.01968326, 0.01948143, 0.01921167, 0.019242890000000002, 0.01896591, 0.01863618, 0.01814646, 0.017857920000000003, 0.0175646, 0.01635642, 0.01614109, 0.01524897, 0.01500212, 0.01443538, 0.01408451, 0.01402769, 0.01366602, 0.01312726, 0.012883839999999999, 0.01261176, 0.01198697, 0.011916719999999999, 0.011284400000000002, 0.01078114, 0.01070816, 0.0102734, 0.0102581, 0.009902959999999999, 0.00904142, 0.008912119999999999, 0.008696019999999999, 0.008386910000000001, 0.00792694, 0.00790352, 0.0076113199999999995, 0.007427629999999999, 0.00739903, 0.007414319999999999, 0.006240300000000001, 0.00614481, 0.00567718, 0.005282199999999999, 0.004992470000000001, 0.004770992, 0.003882436, 0.0038358719999999997, 0.003442273, 0.0033245419999999998, 0.003132704, 0.002249688, 0.002180543, 0.0022252549999999998, 0.002074519, 0.0018851480000000001, 0.001283458, 0.002707175, 0.0010504999999999998, 0.000864783, 0.001204603, 0.0014249040999999999, 0.000722678, 0.00110546, 0.001569023, 0.000381497, 0.00033767300000000003, 0.00030580500000000003, 0.000751201, 0.0001008642, 7.525303e-05, 0.000496526, 0.0002964, 0.000666476, 4.41399e-05, 0.0]
# log3 = [0.03478142, 0.03463405, 0.03439955, 0.03436057, 0.03436821, 0.03433186, 0.0341374, 0.03382379, 0.03347318, 0.03347896, 0.03346098, 0.033365149999999996, 0.03337089, 0.033139810000000006, 0.03315915, 0.03310893, 0.03298548, 0.03303706, 0.03290578, 0.032622120000000004, 0.03255828, 0.03250843, 0.03222441, 0.03216169, 0.03201487, 0.03195624, 0.03187405, 0.03151435, 0.0314447, 0.03127587, 0.03127218, 0.03111368, 0.031010000000000003, 0.031097439999999997, 0.03108032, 0.03100062, 0.030530699999999997, 0.030564969999999997, 0.03019379, 0.03001041, 0.02998723, 0.02963087, 0.02952543, 0.029377050000000002, 0.02888162, 0.028898390000000003, 0.028467899999999997, 0.02821307, 0.02811855, 0.02801132, 0.02768955, 0.027215639999999996, 0.02687139, 0.02648411, 0.02665957, 0.02634111, 0.02622314, 0.02581195, 0.025361059999999998, 0.02474683, 0.024091429999999997, 0.02374317, 0.02379594, 0.023366920000000003, 0.02335659, 0.02330641, 0.02282172, 0.02257941, 0.022265970000000003, 0.02187443, 0.02187173, 0.02139416, 0.02136709, 0.02123668, 0.02108473, 0.020835720000000002, 0.020756289999999997, 0.02070644, 0.0202063, 0.01997745, 0.01944648, 0.01912229, 0.018558690000000003, 0.01835059, 0.01753888, 0.01715925, 0.0170825, 0.01631601, 0.01612147, 0.0161123, 0.01590122, 0.01532774, 0.014864210000000001, 0.014529420000000001, 0.014480779999999999, 0.014384959999999999, 0.014213980000000001, 0.01374942, 0.01370452, 0.01365612, 0.012881400000000001, 0.01268667, 0.0123848, 0.01226062, 0.01176317, 0.01141886, 0.0112322, 0.01052667, 0.01107224, 0.01023401, 0.01018848, 0.01009505, 0.01004029, 0.00896958, 0.008381739999999999, 0.00799714, 0.007949000000000001, 0.00801322, 0.00718818, 0.006600190000000001, 0.00656229, 0.006861561, 0.0056593, 0.00510417, 0.004545428, 0.004001486, 0.003856662, 0.0041537580000000004, 0.0038964259999999997, 0.003573822, 0.003301404, 0.002579021, 0.002275551, 0.002172302, 0.002098706, 0.001866541, 0.001683337, 0.0013982740000000001, 0.001425293, 0.001221852, 0.0010648087, 0.0010525599, 0.001039637, 0.0027926879999999998, 0.003097635, 0.000969821, 0.0004907290000000001, 0.0004588511, 0.0005309965, 0.00044563329999999996, 0.000429297, 0.000374663, 0.00039882299999999997, 0.000260548, 4.00038e-05, 3.69488e-06, 0.00029276059999999997, 0.000212642, 0.0001581218, 0.0]
# log4 = [0.03478142, 0.034330879999999994, 0.0338575, 0.03372472, 0.03373219, 0.03345308, 0.03326138, 0.03320564, 0.03294045, 0.032933319999999995, 0.03305523, 0.03240235, 0.03234425, 0.03181814, 0.03169983, 0.03156264, 0.031428660000000004, 0.03128741, 0.03127165, 0.030927180000000002, 0.030810819999999996, 0.03030683, 0.03044635, 0.02984556, 0.02970724, 0.029252049999999998, 0.02924257, 0.028839369999999996, 0.02857868, 0.029685589999999998, 0.028330119999999997, 0.02825582, 0.028225109999999998, 0.028438460000000002, 0.02813981, 0.027732689999999997, 0.027085690000000003, 0.02701037, 0.02665179, 0.02661471, 0.026501490000000003, 0.02637909, 0.02641513, 0.02627782, 0.0260168, 0.025908920000000002, 0.02536861, 0.02537932, 0.02537638, 0.024677110000000002, 0.024810199999999998, 0.02414452, 0.02371487, 0.02360222, 0.02438361, 0.02400031, 0.02312351, 0.02308094, 0.0229391, 0.022594040000000003, 0.02319042, 0.022568240000000003, 0.02322533, 0.02127648, 0.021259, 0.021238240000000002, 0.02087053, 0.0207974, 0.02056695, 0.0205228, 0.02047098, 0.01991663, 0.01950129, 0.01919095, 0.01908673, 0.019056950000000003, 0.019238909999999998, 0.01855583, 0.01826332, 0.01801692, 0.0179469, 0.01779812, 0.017544300000000002, 0.016757460000000002, 0.016371530000000002, 0.01657604, 0.01659542, 0.01596889, 0.01592302, 0.01586038, 0.01578719, 0.01638662, 0.01594755, 0.01472355, 0.01459302, 0.01480464, 0.014514700000000002, 0.01414176, 0.014223270000000001, 0.0141423, 0.014065679999999999, 0.01417659, 0.013390619999999999, 0.01336484, 0.01312605, 0.01305806, 0.01278402, 0.01299836, 0.012893429999999999, 0.01181187, 0.01175319, 0.011605, 0.01157054, 0.01041942, 0.01029093, 0.010149539999999999, 0.00975279, 0.00943069, 0.00885428, 0.0089406, 0.008465199999999999, 0.008133979999999999, 0.00808468, 0.008610989999999999, 0.00752277, 0.0075265, 0.0072983200000000005, 0.00724771, 0.00707646, 0.00730052, 0.00674822, 0.00677884, 0.00619876, 0.00601906, 0.00576495, 0.00577407, 0.00555868, 0.00494135, 0.0048756, 0.004014114, 0.003664246, 0.00353658, 0.00306062, 0.002949003, 0.0031010239999999995, 0.0035165709999999996, 0.0033390139999999995, 0.002758406, 0.0034250340000000004, 0.0020635840000000003, 0.0021517074000000002, 0.0016527649999999998, 0.0016160380000000002, 0.001667856, 0.002124543, 0.00365928, 0.0021179659999999998, 0.001966519, 0.001151398, 0.0008899153, 0.000785702, 0.0006918639999999999, 0.000625008, 0.000604398, 0.000536445, 0.001124989, 0.000540671, 0.0002040941, 0.0001592601, 0.0001385371, 0.000643678, 0.000523879, 0.00035256969999999997, 0.00029243959999999996, 0.00022658459999999999, 3.983e-05, 0.000112713, 4.82961e-05, 0.000258549, 0.00030999964000000003, 0.000215715, 7.79332e-05, 0.000123444, 6.75461e-05, 0.000594661, 0.000165703, 0.000126438, 8.63399e-05, 0.00029838080000000006, 0.000164198, 0.000242378, 3.95188e-05, 0.0]
# log5 = [0.03478142, 0.03441847, 0.03409517, 0.03367428, 0.03407664, 0.033436629999999995, 0.03338994, 0.03349119, 0.032719979999999996, 0.03271778, 0.03274547, 0.03235444, 0.03190822, 0.03176943, 0.03207679000000001, 0.03163055, 0.031386040000000004, 0.03138577, 0.031339549999999994, 0.03139041, 0.03105426, 0.030856170000000002, 0.030816069999999994, 0.03066336, 0.030648679999999998, 0.030612450000000003, 0.0312191, 0.03080703, 0.030306410000000002, 0.0303289, 0.03003765, 0.029855560000000003, 0.029763710000000002, 0.02954018, 0.029549189999999996, 0.0295431, 0.029530680000000004, 0.0294931, 0.03015199, 0.02882051, 0.02880575, 0.02876436, 0.02855069, 0.02866627, 0.02829241, 0.02786643, 0.027584440000000002, 0.02751972, 0.027134830000000002, 0.027096910000000002, 0.026899479999999996, 0.026495410000000004, 0.02646503, 0.02636404, 0.026050579999999997, 0.02585558, 0.02607702, 0.0252589, 0.02472764, 0.02430955, 0.02407971, 0.023452880000000002, 0.022995950000000005, 0.02264685, 0.02235021, 0.022135719999999998, 0.0206388, 0.02032332, 0.020299110000000002, 0.0202925, 0.020062629999999998, 0.01948004, 0.01926389, 0.018723140000000003, 0.01816193, 0.017207209999999997, 0.01645872, 0.016322549999999998, 0.01579391, 0.01577114, 0.01568446, 0.01488233, 0.014943500000000002, 0.01485072, 0.01462752, 0.0145541, 0.01446404, 0.01374097, 0.013407839999999999, 0.01336625, 0.0132467, 0.012956889999999999, 0.01281134, 0.01197135, 0.011929529999999999, 0.01234909, 0.01193124, 0.01154866, 0.01069426, 0.010645080000000001, 0.01060919, 0.010423299999999998, 0.01080529, 0.01001148, 0.00974894, 0.00971581, 0.009686219999999999, 0.00943042, 0.009192110000000002, 0.00912237, 0.00839039, 0.00833651, 0.00798941, 0.00698915, 0.006283479999999999, 0.006513867000000001, 0.0056253, 0.005384295000000001, 0.00479966, 0.00469526, 0.005443946, 0.004694848999999999, 0.0046372639999999994, 0.004413399, 0.004067896, 0.004059922, 0.0032471139999999997, 0.0032508269999999995, 0.003044129, 0.002861016, 0.00270395, 0.002082059, 0.002046253, 0.0033789420000000002, 0.002333384, 0.002810092, 0.001735032, 0.001788521, 0.002752575, 0.001599478, 0.001521283, 0.001147464, 0.001083013, 0.001953819, 0.0008169029999999999, 0.0008142329999999999, 0.000816754, 0.0009264820000000001, 0.0006574209999999999, 0.000631997, 0.000382895, 0.00045426500000000003, 0.000285165, 0.0001462003, 0.000104063, 0.0001513955, 0.0002605219, 0.000499293, 0.0017168869999999998, 0.0005690700000000001, 0.000203638, 0.0001071342, 0.00010123, 0.0002842829, 0.0001179884, 0.00011479550000000001, 0.000103067, 0.000592607, 0.000443433, 0.0003168524, 0.0002119212, 8.76792e-05, 3.55772e-05, 2.77799e-05, 4.28001e-05, 0.00014732230000000002, 0.0002139981, 0.000251427, 0.000135864, 0.0001004414, 8.81769e-05, 6.79046e-05, 0.0]

# all_logs = [log1, log2, log3, log4, log5]

# read all logs
all_logs = []
with open("loss.txt", "r") as file:
    lines = file.readlines()
    for line in lines:
        log = line.split()
        log = [float(x) for x in log]
        all_logs.append(log)

gen_plot_mean_and_std(all_logs, "toraeq.png", "Tora$_{\mathsf{inf}}$")